The vulnerability arises from an improper authentication check where the function compares only the length of the provided token to a stored secret's length. An unsafe block is used to perform needless raw pointer manipulation without verifying the token’s content, allowing any input of equal length—even an attacker‐chosen token—to bypass authentication. This simulates CWE-287 due to inadequate credential validation.