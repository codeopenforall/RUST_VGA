This version demonstrates CWE-285 – Improper Authorization. The sensitive_action function is intended to restrict access to authorized users only. However, due to a flawed authorization check that incorrectly uses the negation on the privileged flag (i.e. granting access when privileged is false), any caller—including unauthorized ones—can trigger the sensitive operation. Additionally, the use of unsafe blocks with global mutable state further complicates the security posture.