In this version, the function that returns sensitive data is marked as unsafe and performs a flawed authorization check. Instead of verifying that the caller holds the proper privileges, it only checks that the provided username is non-empty. Consequently, any non-empty username — including that of an attacker — is erroneously granted access to the resource. This oversight leads to CWE-285, as insufficient authorization controls can be exploited in concurrent environments.