The revised implementation removes unsafe operations and leverages the standard libraryâ€™s PathBuf for handling file paths. It introduces a normalization function that explicitly rejects parent directory components. In addition, after constructing the candidate path, the code checks that the resolved path begins with the configured base directory. These measures prevent directory traversal attacks by ensuring that even symbolic links or injected "../" sequences cannot result in unauthorized file access.