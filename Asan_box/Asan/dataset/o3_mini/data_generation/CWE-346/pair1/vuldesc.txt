The vulnerable code mistakenly validates the origin header by only checking that its memory pointer is non-null within an unsafe block, without comparing the header's actual content. This flawed logic erroneously approves any incoming request, regardless of an untrusted origin, thereby exposing the application to potential CSRF/SSRF attacks.