This vulnerable code relies on an unsafe global pointer to store the "allowed" origin value extracted from an incoming HTTP request header. By directly assigning the pointer from req.origin without proper validation or isolation from untrusted input, an attacker can submit a malicious Origin value (e.g. "https://evil.com") which then becomes the trusted origin. Subsequent or even the same request will pass the check since the pointer comparison is made against the same manipulated value. This simulates an Origin Validation Error (CWE-346), where the server blindly trusts header values from external input.