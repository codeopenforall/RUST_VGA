The corrected version fixes the vulnerability by replacing the unsynchronized global state with an Arcâ€‘wrapped Mutex protecting the task vector. A capacity limit (MAX_TASKS) is enforced in the expand_queue function, which applies backpressure on incoming workload to prevent uncontrolled resource consumption. This design follows safe Rust practices and eliminates the race condition while remaining true to community idioms.