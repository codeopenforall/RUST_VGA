In this corrected version the unsafe block is preserved for low-level manipulation, but a proper pre-check is added before using the pointer arithmetic. The code validates that the parsed index is less than the array length. If the check fails, an error is returned immediately preventing any possibility of an out‐of‐bounds memory write. This proper input validation fixes the CWE-020 vulnerability.