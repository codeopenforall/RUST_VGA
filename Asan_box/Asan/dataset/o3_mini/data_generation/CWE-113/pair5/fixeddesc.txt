In this revision, the untrusted input is sanitized by filtering out carriage return (CR) and line feed (LF) characters prior to header construction. This prevents CRLF injection by ensuring that the resulting header adheres to the expected format. The unsafe block remains for illustration purposes but now processes a known-safe string, mitigating the vulnerability in a manner aligned with community best practices.