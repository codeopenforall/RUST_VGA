This version creates a memory buffer with a fixed capacity and an additional guard value appended at the end. The function that writes input data uses an unsafe loop without checking that the input length is within the buffer's capacity. Consequently, when input exceeds the capacity, the extra bytes overwrite the guard value, emulating an out-of-bounds write (CWE-787). Concurrency is simulated with an Arc and Mutex.