This implementation contains an improper authentication flaw (CWE-287). It unsafely converts the provided token into a C-style string
without ensuring that the token is null-terminated, potentially reading extra memory. Moreover, it includes a dangerous backdoor by
explicitly granting access when the token equals "test" and also uses a flawed length-check (accepting any token whose length is at least
that of the secret) which circumvents proper credential validation.