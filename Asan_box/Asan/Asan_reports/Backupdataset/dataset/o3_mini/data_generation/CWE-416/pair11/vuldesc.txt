The vulnerability arises from the improper management of heap memory. In the allocation function, memory is allocated using Box and then converted to a raw pointer. Immediately after, the Box is reconstituted from the raw pointer and dropped, freeing the memory. However, the raw pointer is kept in the Resource structure. Later, when the Resource’s method obtains the value via an unsafe dereference, it accesses memory that has already been freed—a classic use-after-free vulnerability (CWE-416). This mimics real-world unsafe Rust issues found in historically reported vulnerabilities.