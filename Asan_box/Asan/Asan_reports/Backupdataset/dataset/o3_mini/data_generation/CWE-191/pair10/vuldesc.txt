This version simulates a realistic integer underflow vulnerability (CWE-191) in a concurrent context. The Ledger struct encapsulates a u32 value within an UnsafeCell to bypass Rust’s usual safety checks, allowing unsynchronized access. The withdraw method subtracts an amount from the balance without verifying if the subtraction would result in an underflow. In scenarios where the withdrawal amount exceeds the current balance—especially when executed concurrently via threads—the arithmetic operation wraps around, yielding an incorrect high value.