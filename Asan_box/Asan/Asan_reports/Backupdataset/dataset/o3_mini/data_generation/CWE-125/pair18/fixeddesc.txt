In this corrected version the extraction function now includes a proper bounds check. Before attempting to read an element, the code verifies that the index is strictly less than the length of the vector. If the index is invalid, None is returned, eliminating the out‐of‐bounds pointer arithmetic. The overall design remains similar (including the use of threads and smart pointers) so that the fix integrates well into real-world idioms while addressing CWE-125.