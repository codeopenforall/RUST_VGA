In this corrected version, the ledgerâ€™s add method uses the safe checked_add operation to ensure that any arithmetic exceeding the capacity of i32 is caught. If an overflow occurs, an error ("integer overflow detected") is returned immediately. This prevents the ledger from holding an invalid value and mitigates the CWE-190 vulnerability. The concurrent simulation now correctly aborts the transaction sequence on detecting an overflow.