The vulnerable code implements an authentication mechanism that compares an input token against a secret. However, it only compares bytes over the length of the shorter stringâ€”if the provided token is a prefix of the secret (for example, "very" for "verysecurekey"), the function erroneously returns true. An unsafe block is used to perform unchecked byte access, mimicking real-world unsafe Rust usage in concurrent services.