In this vulnerable version, the origin header is validated using an unsafe block that dereferences a raw pointer to a String. The check uses a substring match against a constructed expected URL ("https://trusted.com"). This permits crafted headers such as "https://trusted.com@malicious.com" to pass the check, leading to potential CSRF/SSRF pivot issues and bypass of origin validation.