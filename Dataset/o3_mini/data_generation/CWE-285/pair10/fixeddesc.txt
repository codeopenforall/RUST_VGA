In the corrected version, the function run_operation now enforces proper authorization by checking whether a valid credential was provided and if its level meets a minimum threshold (here, level 5). If the caller fails to supply appropriate credentials the function returns an error ("Unauthorized"), thus mitigating the CWE-285 vulnerability. The overall structure and concurrency remain similar to maintain realistic usage, while the safety check ensures that sensitive data is not inadvertently exposed.