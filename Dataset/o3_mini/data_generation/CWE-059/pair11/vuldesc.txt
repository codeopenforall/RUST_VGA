This code first retrieves the metadata of a file and checks that it is a regular file. After a deliberate sleep (to widen the attack window), it opens the file using File::open without preventing symlink following. An attacker may race this window and swap the file with a symlink to an unintended target, causing a time-of-check to time-of-use (TOCTOU) vulnerability (CWE-059). Unsafe code is used for no security-critical purpose besides mimicking low-level operations.