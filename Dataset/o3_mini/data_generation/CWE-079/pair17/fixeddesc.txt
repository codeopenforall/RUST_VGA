In this corrected version the unsafe memory copy and unsanitized input handling have been removed. Instead, a dedicated escape function is used to replace special characters (such as <, >, &, ', and ") with their corresponding HTML entities. This ensures that any injected HTML/JS code provided by an attacker is rendered inert in the browser, effectively mitigating the XSS vulnerability (CWE-079).