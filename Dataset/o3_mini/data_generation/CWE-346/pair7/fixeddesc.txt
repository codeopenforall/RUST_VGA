The fixed code removes the unsafe global mutable pointer and instead relies on a trusted, preconfigured constant for the allowed origin. It no longer accepts the requestâ€™s Origin header as an override for the trusted value. As a result, an attacker cannot trick the system by supplying a malicious header value. All unsafe code related to pointer manipulation has been eliminated, ensuring proper origin validation and resolving the vulnerability.