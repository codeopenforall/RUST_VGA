The corrected implementation addresses the vulnerability by replacing the detailed error messages with a generic response ("Authentication failed") regardless of whether the username is absent or the password is incorrect. A dummy password value is used when the username does not exist, ensuring that the error path runs uniformly. The unsafe block now operates in a constant-time comparison manner, effectively mitigating timing discrepancies and preventing leakage of sensitive state information.