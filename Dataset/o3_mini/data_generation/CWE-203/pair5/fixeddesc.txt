In this revised implementation the error messages no longer provide clues about whether a username exists in the system. Both the invalid username and incorrect password cases return the uniform message "Invalid credentials." This change prevents the leakage of sensitive state and conforms to CWE-203 by not disclosing internal decision details. The concurrent execution and use of unsafe blocks remain to retain realistic application patterns.