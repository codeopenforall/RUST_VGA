async fn download_inner(

    &self,

    url: impl reqwest::IntoUrl,

    maybe_header: Option<(HeaderName, HeaderValue)>,

    progress_guard: Option<&UpdateGuard>,

  ) -> Result<Option<Vec<u8>>, AnyError> {

    let response = self.get_redirected_response(url, maybe_header).await?;



    if response.status() == 404 {

      return Ok(None);

    } else if !response.status().is_success() {

      let status = response.status();

      let maybe_response_text = response.text().await.ok();

      bail!(

        "Bad response: {:?}{}",

        status,

        match maybe_response_text {

          Some(text) => format!("\n\n{text}"),

          None => String::new(),

        }

      );

    }